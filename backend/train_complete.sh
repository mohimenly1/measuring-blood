#!/bin/bash

# ุณูุฑูุจุช ูุงูู ูุชุฏุฑูุจ ุงููููุฐุฌ
# Usage: ./train_complete.sh

cd "$(dirname "$0")"

echo "=" | head -c 60 && echo ""
echo "๐ฏ ุฏููู ุชุฏุฑูุจ ุงููููุฐุฌ ุงููุงูู"
echo "=" | head -c 60 && echo ""
echo ""

# ุงูุฎุทูุฉ 1: ุงูุชุญูู ูู ุงูุจูุงูุงุช
echo "๐ ุงูุฎุทูุฉ 1: ุงูุชุญูู ูู ุจูุงูุงุช ุงูุชุฏุฑูุจ..."
python check_training_data.py

echo ""
read -p "ูู ุชุฑูุฏ ุงููุชุงุจุนุฉุ (y/n) " -n 1 -r
echo ""
if [[ ! $REPLY =~ ^[Yy]$ ]]; then
    echo "ุชู ุงูุฅูุบุงุก"
    exit 1
fi

# ุงูุฎุทูุฉ 2: ุชุตุฏูุฑ ุงูุจูุงูุงุช
echo ""
echo "๐ค ุงูุฎุทูุฉ 2: ุชุตุฏูุฑ ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช..."
python export_training_data.py

if [ $? -ne 0 ]; then
    echo "โ ูุดู ุงูุชุตุฏูุฑ"
    exit 1
fi

# ุงูุฎุทูุฉ 3: ุงูุชุฏุฑูุจ
echo ""
echo "๐ ุงูุฎุทูุฉ 3: ุชุฏุฑูุจ ุงููููุฐุฌ..."
echo "โณ ูุฐุง ูุฏ ูุณุชุบุฑู ุจุนุถ ุงูููุช..."
python train_model.py

if [ $? -eq 0 ]; then
    echo ""
    echo "=" | head -c 60 && echo ""
    echo "โ ุชู ุงูุชุฏุฑูุจ ุจูุฌุงุญ!"
    echo "=" | head -c 60 && echo ""
    echo ""
    echo "๐ก ุฃุนุฏ ุชุดุบูู Backend ูุงุณุชุฎุฏุงู ุงููููุฐุฌ ุงููุฏุฑุจ:"
    echo "   uvicorn main:app --reload --host 0.0.0.0 --port 8000"
else
    echo ""
    echo "โ ูุดู ุงูุชุฏุฑูุจ"
    exit 1
fi

